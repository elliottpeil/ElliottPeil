<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Video Library Player</title>
  <style>
    :root {
      --r-lg: 16px;
      --r-sm: 8px;
      --gap: 20px;
      --default-transition-timing-function: ease-in-out;
      --default-transition-duration: 0.3s;
    }

    * {
      box-sizing: border-box;
    }

    html,
    body {
      height: 100%;
      margin: 0;
      background: #fafafa;
      color: #000;
      font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", Helvetica, Arial, sans-serif;
      font-weight: 300;
    }

    .wrap {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0px 20px;
      display: flex;
      flex-direction: column;
      gap: var(--gap);
    }

    .player {
      position: relative;
      background: #000;
      border-radius: var(--r-lg);
      overflow: hidden;
      display: none;
      margin-bottom: var(--gap);
    }

    .player.active {
      display: block;
    }

    /* Normal video display */
    .player video {
      width: 100%;
      height: auto;
      display: block;
      object-fit: contain;
      -webkit-mask-image: none;
      mask-image: none;
    }

    /* Mobile landscape mini player - smaller size */
    @media (max-width: 926px) and (orientation: landscape) and (max-height: 500px) {
      .player:not(.fullscreen) {
        max-width: 65%;
        /* Slightly smaller for better proportions */
        margin: 0 auto var(--gap);
      }

      .player:not(.fullscreen) video {
        width: 100%;
        height: auto;
      }

      /* Adjust controls for landscape mini player */
      .player:not(.fullscreen) .controls {
        padding: 3px 8px;
        gap: 4px;
        margin: 8px;
        flex-wrap: nowrap;
      }

      .player:not(.fullscreen) .progress-area {
        min-width: 80px;
        gap: 3px;
      }

      .player:not(.fullscreen) .time {
        font-size: 11px;
        min-width: 30px;
      }

      .player:not(.fullscreen) .time.total-time {
        display: none;
        /* Hide total time to save space */
      }

      .player:not(.fullscreen) .volume-slider {
        width: 40px;
      }

      .player:not(.fullscreen) .volume-control label {
        font-size: 10px;
      }

      .player:not(.fullscreen) .speed-control-container {
        padding: 2px 4px;
      }

      .player:not(.fullscreen) .speed-control-container .speed-value {
        width: 30px;
        font-size: 10px;
        padding: 0 3px;
      }

      .player:not(.fullscreen) .speed-control-container .speed-brace {
        width: 12px;
        font-size: 9px;
      }

      .player:not(.fullscreen) .play-btn,
      .player:not(.fullscreen) .fullscreen-btn {
        width: 28px;
        font-size: 11px;
      }
    }

    /* iPhone SE and similar small landscape devices */
    @media (max-width: 667px) and (orientation: landscape) and (max-height: 375px) {
      .player:not(.fullscreen) {
        max-width: 58%;
        /* Even smaller for iPhone SE */
      }

      /* More compact controls for iPhone SE */
      .player:not(.fullscreen) .controls {
        padding: 2px 6px;
        gap: 3px;
        margin: 6px;
      }

      .player:not(.fullscreen) .progress-area {
        min-width: 70px;
        gap: 2px;
      }

      .player:not(.fullscreen) .time {
        font-size: 10px;
        min-width: 28px;
      }

      .player:not(.fullscreen) .volume-slider {
        width: 35px;
      }

      .player:not(.fullscreen) .volume-control label {
        font-size: 9px;
      }

      .player:not(.fullscreen) .speed-control-container {
        padding: 2px 3px;
      }

      .player:not(.fullscreen) .speed-control-container .speed-value {
        width: 28px;
        font-size: 9px;
        padding: 0 2px;
      }

      .player:not(.fullscreen) .speed-control-container .speed-brace {
        width: 10px;
        font-size: 8px;
      }

      .player:not(.fullscreen) .play-btn,
      .player:not(.fullscreen) .fullscreen-btn {
        width: 26px;
        font-size: 10px;
      }
    }

    /* Fullscreen video display - critical fix */
    .player.fullscreen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 9999;
      border-radius: 0;
      cursor: none;
    }

    .player.fullscreen video {
      width: 100vw;
      height: 100vh;
      object-fit: contain;
      /* This ensures proper scaling with black bars */
      background: #000;
    }

    .player.fullscreen.show-cursor {
      cursor: default;
    }

    .controls {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: linear-gradient(rgba(255, 255, 255, .7), rgba(255, 255, 255, 0.4));
      padding: 5px 15px;
      display: flex;
      align-items: center;
      gap: 10px;
      transform: translateY(0);
      transition: opacity 0.3s ease;
      opacity: 1;
      border-radius: 20px;
      margin: 15px;
      box-shadow: 0 3px 10px 5px rgba(0, 0, 0, 0.3);
    }

    .player:hover .controls,
    .controls:hover {
      opacity: 1;
    }

    .player.fullscreen .controls {
      opacity: 1;
      transition: opacity 0.3s ease;
      padding: 5px 10px;
      gap: 8px;
      margin: 10px;
    }

    .player.fullscreen .controls.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .play-btn,
    .fullscreen-btn {
      background: rgba(0, 0, 0, 0.3);
      border: none;
      width: 35px;
      border-radius: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      color: #ffffff6b;
      font-size: 14px;
      transition: background 0.2s ease;
      flex-shrink: 0;
    }

    .play-btn:hover,
    .fullscreen-btn:hover {
      background: rgba(0, 0, 0, 0.4);
    }

    .progress-area {
      flex: 1;
      display: flex;
      align-items: center;
      gap: 8px;
      min-width: 100px;
    }

    .time {
      font-size: 14px;
      color: #00000094;
      min-width: 45px;
      flex-shrink: 0;
      text-align: center;
    }

    .volume-control,
    .speed-control {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .speed-control label {
      display: none;
    }

    .volume-control label {
      font-size: 14px;
      color: rgba(0, 0, 0, 0.6);
    }

    .volume-slider {
      width: 60px;
      -webkit-appearance: none;
      appearance: none;
      background: transparent;
      height: 6px;
      cursor: pointer;
    }

    .volume-slider::-webkit-slider-runnable-track {
      background: rgba(0, 0, 0, 0.3);
      height: 6px;
      border-radius: 3px;
    }

    .volume-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      background: rgba(0, 0, 0, 0.4);
      width: 12px;
      height: 12px;
      border-radius: 50%;
      cursor: pointer;
      margin-top: -3px;
    }

    .volume-slider::-moz-range-track {
      background: rgba(0, 0, 0, 0.6);
      height: 6px;
      border-radius: 3px;
    }

    .volume-slider::-moz-range-thumb {
      background: rgba(0, 0, 0, 0.6);
      border: none;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      cursor: pointer;
    }

    .speed-control-container {
      background: rgba(0, 0, 0, 0.1);
      border-radius: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 4px 6px;
      gap: 2px;
      transition: background 0.2s ease;
      flex-shrink: 0;
    }

    .speed-control-container button,
    .speed-control-container span {
      border-radius: 11px;
      background: rgba(0, 0, 0, 0.3);
      color: #ffffff7d;
      font-size: 12px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .speed-control-container button {
      border: none;
      cursor: pointer;
    }

    .speed-control-container .speed-value {
      width: 40px;
      padding: 0 6px;
    }

    .speed-control-container .speed-brace {
      width: 18px;
      font-size: 12px;
    }

    .speed-control-container button:hover {
      background: rgba(0, 0, 0, 0.4);
    }

    .library {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 25px;
      padding: 20px 0;
    }

    .video-item {
      position: relative;
      cursor: pointer;
      transition: transform 0.3s ease-in-out;
    }

    .video-item:hover {
      transform: scale(1.01);
    }

    .thumbnail-container {
      position: relative;
      overflow: hidden;
    }

    .thumbnail {
      width: 100%;
      aspect-ratio: 16/9;
      object-fit: cover;
      display: block;
      border-radius: var(--r-lg);
    }
    .video-title {
      padding: 10px 0;
      font-weight: 200;
      text-align: center;
      font-size: 16px;
      line-height: 1.3;
      color: #000;
    }

    .no-thumb {
      width: 100%;
      aspect-ratio: 16/9;
      background: linear-gradient(135deg, #ddd, #ccc);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #666;
      font-size: 14px;
      border-radius: var(--r-lg);
    }

    @media (min-width: 769px) {
      .mobile-only {
        display: none;
      }
    }

    @media (max-width: 768px) and (min-width: 501px) {
      .wrap {
        padding: 0px 20px;
      }

      .library {
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        gap: 20px;
      }

      .controls {
        padding: 5px 10px;
        gap: 8px;
      }

      .progress-area {
        flex: 1;
        min-width: 120px;
        gap: 6px;
      }

      .play-btn,
      .fullscreen-btn {
        width: 32px;
        font-size: 13px;
      }

      .time {
        font-size: 13px;
        min-width: 40px;
      }

      .volume-slider {
        width: 50px;
      }

      .speed-control-container {
        padding: 3px 5px;
      }

      .speed-control-container .speed-value {
        width: 36px;
        font-size: 13px;
      }

      .speed-control-container .speed-brace {
        width: 16px;
        font-size: 11px;
      }
    }

    @media (max-width: 500px) {
      .wrap {
        padding: 0px 20px;
      }

      .library {
        grid-template-columns: 1fr;
        gap: 12px;
      }

      .controls {
        padding: 4px 6px;
        gap: 4px;
        flex-wrap: nowrap;
      }

      .progress-area {
        flex: 1;
        min-width: 100px;
        gap: 3px;
        display: flex;
        align-items: center;
      }

      .time {
        font-size: 11px;
        min-width: 30px;
      }

      .time.total-time {
        display: none;
      }

      .volume-control {
        gap: 2px;
      }

      .volume-control label {
        font-size: 11px;
      }

      .volume-slider {
        width: 35px;
      }

      .speed-control-container {
        padding: 2px 4px;
      }

      .speed-control-container .speed-value {
        width: 32px;
        font-size: 11px;
        padding: 0 3px;
      }

      .speed-control-container .speed-brace {
        width: 14px;
        font-size: 10px;
      }

      .play-btn,
      .fullscreen-btn {
        width: 30px;
        font-size: 12px;
      }
    }

    @media (max-width: 450px) {
      .controls {
        padding: 3px 5px;
        gap: 3px;
      }

      .progress-area {
        min-width: 90px;
        gap: 2px;
      }

      .time {
        font-size: 10px;
        min-width: 28px;
      }

      .volume-control label {
        font-size: 10px;
      }

      .volume-slider {
        width: 30px;
      }

      .speed-control-container {
        padding: 2px 3px;
      }

      .speed-control-container .speed-value {
        width: 30px;
        font-size: 10px;
        padding: 0 2px;
      }

      .speed-control-container .speed-brace {
        width: 12px;
        font-size: 9px;
      }

      .play-btn,
      .fullscreen-btn {
        width: 28px;
        font-size: 11px;
      }
    }

    @media (max-width: 320px) {
      .controls {
        padding: 3px 4px;
        gap: 2px;
      }

      .progress-area {
        min-width: 80px;
        gap: 2px;
      }

      .time {
        font-size: 9px;
        min-width: 26px;
      }

      .volume-control label {
        font-size: 9px;
      }

      .volume-slider {
        width: 25px;
      }

      .speed-control-container {
        padding: 2px 2px;
      }

      .speed-control-container .speed-value {
        width: 28px;
        font-size: 9px;
        padding: 0 2px;
      }

      .speed-control-container .speed-brace {
        width: 10px;
        font-size: 8px;
      }

      .play-btn,
      .fullscreen-btn {
        width: 26px;
        font-size: 10px;
      }
    }

    .seek-slider {
      -webkit-appearance: none;
      appearance: none;
      width: 100%;
      height: 6px;
      border-radius: 3px;
      cursor: pointer;
      background:
        linear-gradient(#0000004d 0 0) 0/0% 100% no-repeat,
        rgba(0, 0, 0, 0.2);
    }

    .seek-slider::-webkit-slider-runnable-track {
      height: 6px;
      border-radius: 3px;
      background: transparent;
    }

    .seek-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.4);
      margin-top: -3px;
      cursor: pointer;
    }

    .seek-slider::-moz-range-track {
      height: 6px;
      border-radius: 3px;
      background: transparent;
    }

    .seek-slider::-moz-range-progress {
      background: rgba(0, 0, 0, 0.4);
      height: 6px;
      border-radius: 3px;
    }

    .seek-slider::-moz-range-thumb {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.4);
      border: none;
      cursor: pointer;
    }

    .player.fullscreen .seek-slider {
      height: 8px;
    }

    .player.fullscreen .seek-slider::-webkit-slider-thumb {
      width: 14px;
      height: 14px;
      margin-top: -3px;
    }

    .player.fullscreen .seek-slider::-moz-range-thumb {
      width: 14px;
      height: 14px;
    }
  </style>
</head>

<body>
  <p style="text-align:center;margin: 20px 0 0;padding-top: 35px;padding-bottom: 20px;">
    <a href="../index.html">&lt; Home</a>
  </p>
  <div class="wrap">
    <div class="player" id="player">
      <video id="video" preload="metadata"></video>
      <div class="controls" id="controls">
        <button class="play-btn" id="playBtn">▶</button>
        <div class="progress-area">
          <div class="time" id="currentTime">0:00</div>
          <input type="range" id="seek" class="seek-slider" min="0" max="100" step="0.1" value="0" aria-label="Seek">
          <div class="time total-time" id="totalTime">0:00</div>
        </div>
        <div class="volume-control">
          <label for="volumeSlider">Vol</label>
          <input type="range" id="volumeSlider" class="volume-slider" min="0" max="1" step="0.01" value="1">
        </div>
        <div class="speed-control">
          <label for="speedLeftBrace">Speed</label>
          <div class="speed-control-container" id="speedControl">
            <button class="speed-brace" id="speedLeftBrace">&lt;</button>
            <span class="speed-value" id="speedValue">1x</span>
            <button class="speed-brace" id="speedRightBrace">&gt;</button>
          </div>
        </div>
        <button class="fullscreen-btn" id="fullscreenBtn">⛶</button>
      </div>
    </div>

    <div class="library" id="library"></div>
  </div>
  <script>
    (() => {
      const player = document.getElementById('player');
      const video = document.getElementById('video');
      const library = document.getElementById('library');
      const playBtn = document.getElementById('playBtn');
      const currentTime = document.getElementById('currentTime');
      const totalTime = document.getElementById('totalTime');
      const volumeSlider = document.getElementById('volumeSlider');
      const speedValue = document.getElementById('speedValue');
      const speedLeftBrace = document.getElementById('speedLeftBrace');
      const speedRightBrace = document.getElementById('speedRightBrace');
      const fullscreenBtn = document.getElementById('fullscreenBtn');
      const controls = document.getElementById('controls');
      const seek = document.getElementById('seek');

      const speeds = [0.25, 0.5, 0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75, 3];
      let currentSpeedIndex = 3; // Start at 1x

      function updateSeekUI(pct) {
        seek.value = pct;
        seek.style.backgroundSize = pct + '% 100%';
      }

      const videos = [
        {
          title: "Poke - Elliott Peil",
          file: "../videos/Poke - Elliott Peil.mp4",
          thumbnail: "../thumbnails/pokethumb.webp"
        },
        {
          title: "Fish - Elliott Peil",
          file: "../videos/Fish - Elliott Peil.mp4",
          thumbnail: "../thumbnails/fishthumb.jpg"
        },
        {
          title: "I'm Nothing - Elliott Peil",
          file: "../videos/I'm Nothing - Elliott Peil.mp4",
          thumbnail: "../thumbnails/imnothingthumb.webp"
        },
        {
          title: "Why Does Homosexuality Exist?",
          file: "../videos/Why Does Homosexuality Exist_.mp4",
          thumbnail: "../thumbnails/whydoeshomosexualityexistthumb.jpg"
        },
        {
          title: "Contact - Elliott Peil (lyric video)",
          file: "../videos/Contact - Elliott Peil (lyric video).mp4",
          thumbnail: "../thumbnails/contactthumb.webp"
        },

      ];

      let currentVideo = null;
      let hideControlsTimeout;
      let hideCursorTimeout;

      function formatTime(seconds) {
        if (!isFinite(seconds)) return "0:00";
        const m = Math.floor(seconds / 60);
        const s = Math.floor(seconds % 60);
        return `${m}:${s.toString().padStart(2, '0')}`;
      }

      function generateThumbnails(videoSrc, callback, errorCallback) {
        const tempVideo = document.createElement('video');
        tempVideo.src = videoSrc;
        tempVideo.preload = 'metadata';
        tempVideo.muted = true;
        tempVideo.playsInline = true;
        const thumbnails = [];
        let loadedCount = 0;
        const totalSnapshots = 9;

        const onLoadedMetadata = () => {
          const duration = tempVideo.duration;
          const interval = duration / (totalSnapshots + 1);

          const captureSnapshot = (time) => {
            tempVideo.currentTime = time;
          };

          const onSeeked = () => {
            const canvas = document.createElement('canvas');
            canvas.width = tempVideo.videoWidth / 2;
            canvas.height = tempVideo.videoHeight / 2;
            const ctx = canvas.getContext('2d');
            if (ctx) {
              ctx.drawImage(tempVideo, 0, 0, canvas.width, canvas.height);
              thumbnails.push(canvas.toDataURL('image/png'));
            }
            loadedCount++;
            if (loadedCount < totalSnapshots) {
              captureSnapshot(interval * (loadedCount + 1));
            } else {
              callback(thumbnails);
              cleanup();
            }
          };

          const onError = () => {
            errorCallback();
            cleanup();
          };

          const cleanup = () => {
            tempVideo.removeEventListener('loadedmetadata', onLoadedMetadata);
            tempVideo.removeEventListener('seeked', onSeeked);
            tempVideo.removeEventListener('error', onError);
            tempVideo.remove();
          };

          tempVideo.addEventListener('seeked', onSeeked);
          tempVideo.addEventListener('error', onError);
          captureSnapshot(interval);
        };

        tempVideo.addEventListener('loadedmetadata', onLoadedMetadata);
        tempVideo.addEventListener('error', () => {
          errorCallback();
          tempVideo.remove();
        });
        tempVideo.load();
      }

      function createVideoItem(videoData, index) {
        const item = document.createElement('div');
        item.className = 'video-item';
        item.onclick = () => playVideo(videoData);

        const thumbnailContainer = document.createElement('div');
        thumbnailContainer.className = 'thumbnail-container';

        if (videoData.thumbnail) {
          const thumbnail = document.createElement('img');
          thumbnail.className = 'thumbnail';
          thumbnail.src = videoData.thumbnail;
          thumbnail.alt = videoData.title;
          thumbnail.onerror = () => {
            thumbnailContainer.innerHTML = '';
            thumbnailContainer.style.display = 'grid';
            thumbnailContainer.style.gridTemplateColumns = 'repeat(3, 1fr)';
            thumbnailContainer.style.gap = '2px';
            generateThumbnails(videoData.file, (thumbnails) => {
              thumbnails.forEach((src) => {
                const thumb = document.createElement('img');
                thumb.className = 'thumbnail';
                thumb.src = src;
                thumb.alt = videoData.title;
                thumbnailContainer.appendChild(thumb);
              });
            }, () => {
              const noThumb = document.createElement('div');
              noThumb.className = 'no-thumb';
              noThumb.textContent = 'No Preview Available';
              item.replaceChild(noThumb, thumbnailContainer);
            });
          };
          thumbnailContainer.appendChild(thumbnail);
        } else {
          thumbnailContainer.style.display = 'grid';
          thumbnailContainer.style.gridTemplateColumns = 'repeat(3, 1fr)';
          thumbnailContainer.style.gap = '2px';
          generateThumbnails(videoData.file, (thumbnails) => {
            thumbnails.forEach((src) => {
              const thumbnail = document.createElement('img');
              thumbnail.className = 'thumbnail';
              thumbnail.src = src;
              thumbnail.alt = videoData.title;
              thumbnailContainer.appendChild(thumbnail);
            });
          }, () => {
            const noThumb = document.createElement('div');
            noThumb.className = 'no-thumb';
            noThumb.textContent = 'No Preview Available';
            item.replaceChild(noThumb, thumbnailContainer);
          });
        }

        const title = document.createElement('div');
        title.className = 'video-title';
        title.textContent = videoData.title;

        item.appendChild(thumbnailContainer);
        item.appendChild(title);
        return item;
      }

      function playVideo(videoData) {
        currentVideo = videoData;
        video.src = videoData.file;
        player.classList.add('active');
        player.scrollIntoView({ behavior: 'smooth', block: 'start' });
        video.addEventListener('loadeddata', () => {
          video.play();
        }, { once: true });
      }

      function togglePlay() {
        if (video.paused) {
          video.play();
        } else {
          video.pause();
        }
      }

      function setSpeed(speed) {
        video.playbackRate = speed;
        speedValue.textContent = `${speed}x`;
      }

      function toggleFullscreen() {
        if (!document.fullscreenElement) {
          player.requestFullscreen?.();
          player.classList.add('fullscreen');
          fullscreenBtn.textContent = '⤴';
        } else {
          document.exitFullscreen?.();
          player.classList.remove('fullscreen');
          fullscreenBtn.textContent = '⛶';
        }
      }

      function resetHideControlsTimer() {
        controls.classList.remove('hidden');
        player.classList.add('show-cursor');

        clearTimeout(hideControlsTimeout);
        clearTimeout(hideCursorTimeout);

        if (player.classList.contains('fullscreen') || currentVideo) {
          hideControlsTimeout = setTimeout(() => {
            controls.classList.add('hidden');
          }, 5000);

          hideCursorTimeout = setTimeout(() => {
            player.classList.remove('show-cursor');
          }, 5000);
        }
      }

      videos.forEach((videoData, index) => {
        library.appendChild(createVideoItem(videoData, index));
      });

      playBtn.addEventListener('click', togglePlay);

      video.addEventListener('click', (e) => {
        if (e.target === video) {
          togglePlay();
          resetHideControlsTimer();
        }
      });

      video.addEventListener('play', () => {
        playBtn.textContent = '⏸';
      });

      video.addEventListener('pause', () => {
        playBtn.textContent = '▶';
      });

      video.addEventListener('loadedmetadata', () => {
        totalTime.textContent = formatTime(video.duration);
        updateSeekUI(0);
      });

      video.addEventListener('timeupdate', () => {
        currentTime.textContent = formatTime(video.currentTime);
        const pct = video.duration ? (video.currentTime / video.duration) * 100 : 0;
        updateSeekUI(pct);
      });

      seek.addEventListener('input', () => {
        if (!video.duration) return;
        const t = (seek.value / 100) * video.duration;
        video.currentTime = t;
        resetHideControlsTimer();
      });

      const progressArea = document.querySelector('.progress-area');
      progressArea.addEventListener('click', (e) => {
        if (!video.duration || e.target === seek) return;
        const rect = progressArea.getBoundingClientRect();
        const pos = (e.clientX - rect.left) / rect.width;
        video.currentTime = pos * video.duration;
        updateSeekUI(pos * 100);
        resetHideControlsTimer();
      });

      volumeSlider.addEventListener('input', () => {
        video.volume = volumeSlider.value;
        resetHideControlsTimer();
      });

      speedLeftBrace.addEventListener('click', () => {
        currentSpeedIndex = (currentSpeedIndex - 1 + speeds.length) % speeds.length;
        const newSpeed = speeds[currentSpeedIndex];
        setSpeed(newSpeed);
        resetHideControlsTimer();
      });

      speedRightBrace.addEventListener('click', () => {
        currentSpeedIndex = (currentSpeedIndex + 1) % speeds.length;
        const newSpeed = speeds[currentSpeedIndex];
        setSpeed(newSpeed);
        resetHideControlsTimer();
      });

      fullscreenBtn.addEventListener('click', () => {
        toggleFullscreen();
        resetHideControlsTimer();
      });

      // Mouse and touch events for showing/hiding controls
      player.addEventListener('mousemove', resetHideControlsTimer);
      player.addEventListener('touchstart', resetHideControlsTimer);
      player.addEventListener('touchmove', resetHideControlsTimer);

      // Show controls when interacting with them
      controls.addEventListener('mouseenter', () => {
        controls.classList.remove('hidden');
        player.classList.add('show-cursor');
        clearTimeout(hideControlsTimeout);
        clearTimeout(hideCursorTimeout);
      });

      controls.addEventListener('mouseleave', resetHideControlsTimer);

      player.addEventListener('click', (e) => {
        if (e.target === player && !document.fullscreenElement) {
          player.classList.remove('active');
          video.pause();
          currentVideo = null;
          clearTimeout(hideControlsTimeout);
          clearTimeout(hideCursorTimeout);
          controls.classList.remove('hidden');
          player.classList.add('show-cursor');
        }
      });

      document.addEventListener('fullscreenchange', () => {
        if (!document.fullscreenElement) {
          player.classList.remove('fullscreen');
          fullscreenBtn.textContent = '⛶';
          controls.classList.remove('hidden');
          player.classList.add('show-cursor');
          clearTimeout(hideControlsTimeout);
          clearTimeout(hideCursorTimeout);
        } else {
          resetHideControlsTimer();
        }
      });

      document.addEventListener('keydown', (e) => {
        if (!currentVideo) return;
        resetHideControlsTimer();
        switch (e.code) {
          case 'Space':
            e.preventDefault();
            togglePlay();
            break;
          case 'ArrowLeft':
            e.preventDefault();
            video.currentTime = Math.max(0, video.currentTime - 10);
            break;
          case 'ArrowRight':
            e.preventDefault();
            video.currentTime = Math.min(video.duration || 0, video.currentTime + 10);
            break;
          case 'Escape':
            if (document.fullscreenElement) {
              toggleFullscreen();
            } else {
              player.classList.remove('active');
              video.pause();
              currentVideo = null;
              clearTimeout(hideControlsTimeout);
              clearTimeout(hideCursorTimeout);
              controls.classList.remove('hidden');
              player.classList.add('show-cursor');
            }
            break;
          case 'KeyF':
            e.preventDefault();
            toggleFullscreen();
            break;
        }
      });

      // Initialize controls visibility when video starts
      video.addEventListener('loadstart', () => {
        resetHideControlsTimer();
      });
    })();
  </script>
</body>

</html>